{"ast":null,"code":"import _objectSpread from \"/Users/Macbook/WebstormProjects/mfg-4b-sz/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/Macbook/WebstormProjects/mfg-4b-sz/src/App.js\";\nimport React from 'react';\nimport { StateProvider, persistState } from './global/state';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\nimport Layout from './containers/Layout/Layout';\nimport LayoutOfManager from './containers/Layout/LayoutOfManager';\nimport Login from './containers/Login/Login';\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#1b5e20' //134e32\n\n    },\n    secondary: {\n      main: '#73c5be' //e31b2f\n\n    }\n  },\n  status: {\n    danger: 'orange'\n  }\n}); //const AppContext = React.createContext();\n\nconst App = props => {\n  const initialState = {\n    appState: {\n      logon: false,\n      role: '',\n      username: '',\n      store: '',\n      sitegroup: ''\n    },\n    dataState: {\n      interval: 60000,\n      order_instore: [],\n      cooking: [],\n      delivering: [],\n      delivered: [],\n      cancelled: [],\n      snackbar: {\n        open: false,\n        msg: ''\n      }\n    },\n    previousState: {}\n  };\n  const persistedState = sessionStorage.getItem(\"sessionstate\") ? JSON.parse(sessionStorage.getItem(\"sessionstate\")) : initialState;\n\n  const reducer = (state, action) => {\n    console.group('Reducer :');\n    console.log('action : ' + action.type);\n    var saved = Object.assign(_objectSpread({}, state));\n\n    switch (action.type) {\n      case 'LOGIN_SUCCESS':\n        saved.appState.logon = true;\n        saved.appState.username = action.data.username;\n        saved.appState.role = action.data.role;\n        saved.appState.store = action.data.site;\n        saved.appState.sitegroup = action.data.sitegroup;\n        persistState(saved);\n        return _objectSpread({}, saved);\n\n      case 'FRESH_ORDER_INSTORE_SUCCESS':\n        var origin = action.data;\n        saved.dataState.order_instore = origin; //data is list of rows []\n\n        saved.dataState.cooking = [...origin].filter(order => {\n          return (order.cookingFinishTime === null || order.cookingFinishTime === '') && (order.pickupFinishTime === null || order.pickupFinishTime === '') && (order.cancelTime === null || order.cancelTime === '');\n        }).map(row => {\n          var raw = JSON.parse(row.json);\n          return {\n            databaseId: row.id,\n            status: 'cooking',\n            orderName: row.orderName,\n            orderTime: row.tranDate,\n            future: row.orderType === 0 ? '' : row.dueDate,\n            grossTotal: raw.SDM.GrossTotal\n          };\n        });\n        console.group('Rendering cooking ' + saved.dataState.cooking.length + ' record(s)');\n        console.log(saved.dataState.cooking);\n        console.groupEnd();\n        saved.dataState.delivering = [...origin].filter(order => {\n          return order.cookingFinishTime !== null && (order.pickupFinishTime === null || order.pickupFinishTime === '') && (order.cancelTime === null || order.cancelTime === '');\n        }).map(row => {\n          var raw = JSON.parse(row.json);\n          return {\n            databaseId: row.id,\n            status: 'Ready To Pickup',\n            orderName: row.orderName,\n            orderTime: row.tranDate,\n            future: row.orderType === 0 ? '' : row.dueDate,\n            grossTotal: raw.SDM.GrossTotal\n          };\n        });\n        console.group('Rendering delivering ' + saved.dataState.delivering.length + ' record(s)');\n        console.log(saved.dataState.delivering);\n        console.groupEnd();\n        saved.dataState.delivered = [...origin].filter(order => {\n          return order.cookingFinishTime !== null && order.pickupFinishTime !== null && (order.cancelTime === null || order.cancelTime === '');\n        }).map(row => {\n          var raw = JSON.parse(row.json);\n          return {\n            databaseId: row.id,\n            status: 'Delivering',\n            orderName: row.orderName,\n            orderTime: row.tranDate,\n            future: row.orderType === 0 ? '' : row.dueDate,\n            grossTotal: raw.SDM.GrossTotal\n          };\n        });\n        console.group('Rendering delivered ' + saved.dataState.delivered.length + ' record(s)');\n        console.log(saved.dataState.delivered);\n        console.groupEnd();\n        saved.dataState.cancelled = [...origin].filter(order => {\n          return order.cancelTime !== null;\n        }).map(row => {\n          var raw = JSON.parse(row.json);\n          return {\n            databaseId: row.id,\n            status: 'Cancelled',\n            orderName: row.orderName,\n            orderTime: row.tranDate,\n            future: row.orderType === 0 ? '' : row.dueDate,\n            grossTotal: raw.SDM.GrossTotal\n          };\n        });\n        console.group('Rendering cancelled ' + saved.dataState.cancelled.length + ' record(s)');\n        console.log(saved.dataState.cancelled);\n        console.groupEnd();\n        persistState(saved);\n        return _objectSpread({}, saved);\n\n      case 'REMOVE_COOKING':\n        var copyState = [...saved.dataState.cooking];\n        saved.dataState.cooking = copyState.filter(order => {\n          return order.databaseId !== action.data; //id\n        });\n        console.group('RowID[' + action.data + '] was removed');\n        console.groupEnd();\n        persistState(saved);\n        console.group('Rendering cooking');\n        console.log(saved.dataState.cooking);\n        console.groupEnd();\n        return _objectSpread({}, saved);\n\n      case 'MOVE_TO_DELIVERING':\n        console.group('Row moved:');\n        var moved = [{\n          databaseId: action.data.databaseId,\n          status: 'delivering',\n          orderName: action.data.orderName,\n          orderTime: action.data.orderTime,\n          future: action.data.future,\n          grossTotal: action.data.grossTotal\n        }];\n        console.log(moved); //rowData\n\n        console.groupEnd();\n        var copyState = [...saved.dataState.delivering].concat(moved);\n        saved.dataState.delivering = copyState;\n        console.group('Rendering delivering');\n        console.log(saved.dataState.delivering);\n        console.groupEnd();\n        persistState(saved);\n        return _objectSpread({}, saved);\n\n      case 'SNACKBAR':\n        saved.dataState.snackbar = action.data;\n        persistState(saved);\n        return _objectSpread({}, saved);\n\n      default:\n        return state;\n    }\n\n    console.groupEnd();\n  };\n\n  const checkForAuth = (props, path) => {\n    console.log('log on state : ' + persistedState.appState.logon);\n\n    if (persistedState.appState.logon) {\n      /*\n      if(path === '/ordering'){\n        return (\n          <Layout>\n            <Ordering></Ordering>\n          </Layout>\n        );\n      }else if(path === '/order_ready'){\n        return (\n          <Layout>\n            <OrderReady></OrderReady>\n          </Layout>\n        );\n      }else if(path === '/driver_ready'){\n        return (\n          <Layout>\n            <DriverReady></DriverReady>\n          </Layout>\n        );\n      }else\n      {\n        return (\n          <Layout>\n            <Ordering></Ordering>\n          </Layout>\n        );\n      }\n      */\n      if (persistedState.appState.role === 'user') {\n        return React.createElement(Layout, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 230\n          },\n          __self: this\n        }, \" \");\n      } else if (persistedState.appState.role === 'manager') {\n        return React.createElement(LayoutOfManager, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        });\n      }\n    }\n\n    return React.createElement(Login, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, \"login\"));\n  };\n\n  const switchRoute = props => {\n    return React.createElement(Switch, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(Route, {\n      exact: true,\n      path: \"/ordering\",\n      render: props => checkForAuth(props, '/ordering'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/order_ready\",\n      render: props => checkForAuth(props, '/order_ready'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/driver_ready\",\n      render: props => checkForAuth(props, '/driver_ready'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }), React.createElement(Route, {\n      render: props => checkForAuth(props, '/ordering'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }));\n  };\n\n  return React.createElement(StateProvider, {\n    initialState: persistedState,\n    reducer: reducer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258\n    },\n    __self: this\n  }, React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259\n    },\n    __self: this\n  }, React.createElement(ThemeProvider, {\n    theme: theme,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260\n    },\n    __self: this\n  }, React.createElement(CssBaseline, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261\n    },\n    __self: this\n  }), React.createElement(Router, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262\n    },\n    __self: this\n  }, switchRoute(props)))));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/Macbook/WebstormProjects/mfg-4b-sz/src/App.js"],"names":["React","StateProvider","persistState","CssBaseline","ThemeProvider","createMuiTheme","BrowserRouter","Router","Switch","Route","Layout","LayoutOfManager","Login","theme","palette","primary","main","secondary","status","danger","App","props","initialState","appState","logon","role","username","store","sitegroup","dataState","interval","order_instore","cooking","delivering","delivered","cancelled","snackbar","open","msg","previousState","persistedState","sessionStorage","getItem","JSON","parse","reducer","state","action","console","group","log","type","saved","Object","assign","data","site","origin","filter","order","cookingFinishTime","pickupFinishTime","cancelTime","map","row","raw","json","databaseId","id","orderName","orderTime","tranDate","future","orderType","dueDate","grossTotal","SDM","GrossTotal","length","groupEnd","copyState","moved","concat","checkForAuth","path","switchRoute"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { StateProvider, persistState } from './global/state'\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport Layout from './containers/Layout/Layout'\nimport LayoutOfManager from './containers/Layout/LayoutOfManager'\nimport Login from './containers/Login/Login'\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: '#1b5e20', //134e32\n    },\n    secondary: {\n      main: '#73c5be', //e31b2f\n    },\n  },\n  status: {\n    danger: 'orange',\n  },\n});\n\n//const AppContext = React.createContext();\n\nconst App = (props) => {\n  const initialState = {\n    appState: {\n      logon: false,\n      role: '',\n      username: '',\n      store: '',\n      sitegroup: '',\n    },\n    dataState: {\n      interval: 60000,\n      order_instore: [],\n      cooking: [],\n      delivering: [],\n      delivered: [],\n      cancelled: [],\n      snackbar: {\n        open: false,\n        msg: ''\n      }\n    },\n    previousState: {}\n  }\n\n  const persistedState = sessionStorage.getItem(\"sessionstate\")\n    ? JSON.parse(sessionStorage.getItem(\"sessionstate\"))\n    : initialState;\n\n  const reducer = (state, action) => {\n    console.group('Reducer :');\n    console.log('action : '+action.type);\n\n    var saved = Object.assign({ ...state });\n    switch (action.type) {\n      case 'LOGIN_SUCCESS':\n        saved.appState.logon = true;\n        saved.appState.username = action.data.username;\n        saved.appState.role = action.data.role;\n        saved.appState.store = action.data.site;\n        saved.appState.sitegroup = action.data.sitegroup;\n        persistState(saved);\n        return {\n          ...saved,\n          //theme: action.newTheme\n        };\n      case 'FRESH_ORDER_INSTORE_SUCCESS':\n        var origin = action.data;\n        saved.dataState.order_instore = origin; //data is list of rows []\n        saved.dataState.cooking = [...origin].filter(order => {\n                                                return (order.cookingFinishTime === null || order.cookingFinishTime === '')\n                                                    && (order.pickupFinishTime === null || order.pickupFinishTime === '')\n                                                    && (order.cancelTime === null || order.cancelTime === '')\n                                              }).map(row => {\n                                                var raw =  JSON.parse(row.json);\n                                                return {\n                                                  databaseId: row.id,\n                                                  status: 'cooking',\n                                                  orderName: row.orderName,\n                                                  orderTime: row.tranDate,\n                                                  future: row.orderType === 0 ? '' : row.dueDate,\n                                                  grossTotal: raw.SDM.GrossTotal\n                                                }\n                                              });\n        console.group('Rendering cooking '+saved.dataState.cooking.length + ' record(s)');\n        console.log(saved.dataState.cooking);\n        console.groupEnd();\n        saved.dataState.delivering = [...origin].filter(order => {\n                                                return (order.cookingFinishTime !== null )\n                                                    && (order.pickupFinishTime === null || order.pickupFinishTime === '')\n                                                    && (order.cancelTime === null || order.cancelTime === '')\n                                              }).map(row => {\n                                                var raw =  JSON.parse(row.json);\n                                                return {\n                                                  databaseId: row.id,\n                                                  status: 'Ready To Pickup',\n                                                  orderName: row.orderName,\n                                                  orderTime: row.tranDate,\n                                                  future: row.orderType === 0 ? '' : row.dueDate,\n                                                  grossTotal: raw.SDM.GrossTotal\n                                                }\n                                              });\n        console.group('Rendering delivering '+saved.dataState.delivering.length + ' record(s)');\n        console.log(saved.dataState.delivering);\n        console.groupEnd();\n        saved.dataState.delivered = [...origin].filter(order => {\n                                                  return (order.cookingFinishTime !== null )\n                                                      && (order.pickupFinishTime !== null )\n                                                      && (order.cancelTime === null || order.cancelTime === '')\n                                                }).map(row => {\n                                                  var raw =  JSON.parse(row.json);\n                                                  return {\n                                                    databaseId: row.id,\n                                                    status: 'Delivering',\n                                                    orderName: row.orderName,\n                                                    orderTime: row.tranDate,\n                                                    future: row.orderType === 0 ? '' : row.dueDate,\n                                                    grossTotal: raw.SDM.GrossTotal\n                                                  }\n                                                });\n        console.group('Rendering delivered '+saved.dataState.delivered.length + ' record(s)');\n        console.log(saved.dataState.delivered);\n        console.groupEnd();\n        saved.dataState.cancelled = [...origin].filter(order => {\n                                                  return (order.cancelTime !== null )\n                                                }).map(row => {\n                                                  var raw =  JSON.parse(row.json);\n                                                  return {\n                                                    databaseId: row.id,\n                                                    status: 'Cancelled',\n                                                    orderName: row.orderName,\n                                                    orderTime: row.tranDate,\n                                                    future: row.orderType === 0 ? '' : row.dueDate,\n                                                    grossTotal: raw.SDM.GrossTotal\n                                                  }\n                                                });\n        console.group('Rendering cancelled '+saved.dataState.cancelled.length + ' record(s)');\n        console.log(saved.dataState.cancelled);\n        console.groupEnd();\n        persistState(saved);\n        return {\n          ...saved,\n        };\n      case 'REMOVE_COOKING' :\n        var copyState = [...saved.dataState.cooking];\n        saved.dataState.cooking = copyState.filter(order =>{\n          return order.databaseId !== action.data; //id\n        })\n        console.group('RowID['+action.data+'] was removed');\n        console.groupEnd();\n        persistState(saved);\n        console.group('Rendering cooking');\n        console.log(saved.dataState.cooking);\n        console.groupEnd();\n        return {\n          ...saved,\n        };\n      case 'MOVE_TO_DELIVERING' :\n        console.group('Row moved:');\n        var moved = [{\n          databaseId: action.data.databaseId,\n          status: 'delivering',\n          orderName: action.data.orderName,\n          orderTime: action.data.orderTime,\n          future: action.data.future,\n          grossTotal: action.data.grossTotal\n        }];\n        console.log(moved); //rowData\n        console.groupEnd();\n        var copyState = [...saved.dataState.delivering].concat(moved);\n        saved.dataState.delivering = copyState;\n        console.group('Rendering delivering');\n        console.log(saved.dataState.delivering);\n        console.groupEnd();\n        persistState(saved);\n        return {\n          ...saved,\n        };\n      case 'SNACKBAR':\n        saved.dataState.snackbar = action.data;\n        persistState(saved);\n        return {\n          ...saved,\n        }\n      default:\n        return state;\n    }\n    console.groupEnd();\n\n  };\n\n  const checkForAuth = (props,path) => {\n    console.log('log on state : ' + persistedState.appState.logon);\n    if (persistedState.appState.logon) {\n      /*\n      if(path === '/ordering'){\n        return (\n          <Layout>\n            <Ordering></Ordering>\n          </Layout>\n        );\n      }else if(path === '/order_ready'){\n        return (\n          <Layout>\n            <OrderReady></OrderReady>\n          </Layout>\n        );\n      }else if(path === '/driver_ready'){\n        return (\n          <Layout>\n            <DriverReady></DriverReady>\n          </Layout>\n        );\n      }else\n      {\n        return (\n          <Layout>\n            <Ordering></Ordering>\n          </Layout>\n        );\n      }\n      */\n      if(persistedState.appState.role === 'user') {\n        return (<Layout> {/* {props.children}*/}</Layout>);\n      }else if(persistedState.appState.role === 'manager'){\n        return (<LayoutOfManager/>);\n      }\n    }\n    return (\n      <Login>\n        <div>login</div>\n      </Login>\n    );\n  };\n\n  const switchRoute = (props) => {\n  \n    return (\n      <Switch>\n        <Route exact path='/ordering'\n          render={(props) => checkForAuth(props,'/ordering')} />\n        <Route exact path='/order_ready'\n          render={(props) => checkForAuth(props,'/order_ready')} />\n        <Route exact path='/driver_ready'\n          render={(props) => checkForAuth(props,'/driver_ready')} />\n        <Route render={(props) => checkForAuth(props,'/ordering')} />\n      </Switch>\n    );\n  };\n\n  return (\n    <StateProvider initialState={persistedState} reducer={reducer}>\n      <React.Fragment>\n        <ThemeProvider theme={theme}>\n          <CssBaseline />\n          <Router>\n            {switchRoute(props)}\n          </Router>\n        </ThemeProvider>\n      </React.Fragment>\n    </StateProvider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}